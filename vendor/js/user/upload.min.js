function isUploading(){let e=document.querySelectorAll(".description-col input");for(let t=e.length-1;t>=0;t--)if(""!==e[t].value.trim())return!0;return""!==document.getElementsByClassName("upload-image")[0].value}document.getElementsByClassName("close")[0].addEventListener("click",function(){this.parentNode.css({opacity:0,visibility:"hidden"})});try{let e=document.getElementsByClassName("upload-image")[0];window.File&&window.FileReader&&window.FileList&&window.Blob?e.addEventListener("change",readImg,!1):console.warn("The browser does not support File API");function readImg(t){document.getElementsByClassName("preview")[0].setAttribute("data","");let r=t.target.files[0];if(r&&r.type.match("image.*")){let t=new FileReader,n=new Image;t.onload=function(t){if(document.getElementById("preview-image"))document.getElementById("preview-image").src=t.target.result;else{const r=document.createElement("img");r.id="preview-image",r.classList.add("preview-image"),r.src=t.target.result,e.parentNode.insertBefore(r,e)}},t.readAsDataURL(r),n.onload=function(){(this.width<400||this.height<100)&&(showError(e,"Kích thước ảnh tối thiểu là 400x100"),e.value="")},n.src=(window.URL||window.webkitURL).createObjectURL(r)}else showError(e,"Không đúng định dạng ảnh"),e.value=""}}catch(e){console.warn(e)}document.querySelector(".upload form").addEventListener("submit",function(e){e.preventDefault();let t=document.querySelector("input[name=title]"),r=document.querySelector("input[name=tags]"),n=document.querySelector("input[name=image]");return""===t.value.trim()?(t.parentNode.classList.add("error"),showError(t,"Phải có tiêu đề của ảnh")):t.value.trim().length>255?(t.parentNode.classList.add("error"),showError(t,"Tiêu đề quá dài")):""===r.value.trim()?(r.parentNode.classList.add("error"),showError(r,"Phải gắn thẻ cho ảnh")):r.value.trim().split(",").length>5?(r.parentNode.classList.add("error"),showError(r,"Tối đa 5 thẻ")):n&&""===n.value.trim()?showError(n,"Chưa có ảnh nào được chọn"):void this.submit()}),window.addEventListener("beforeunload",function(e){if(isUploading())return e.preventDefault(),(e||window.event).returnValue="a","a"});